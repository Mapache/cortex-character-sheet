<!doctype html>
<html lang=en>
  <head>
    <meta charset=utf-8>
    <link rel="stylesheet" href="https://p.trellocdn.com/power-up.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <style>
        .mb-delete
        {
            cursor: pointer;
        }
    </style>
    <title>Parent card</title>
  </head>
  <body>
    <div id='parent'></div>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script>
        var Promise = TrelloPowerUp.Promise;
        var t = TrelloPowerUp.iframe();
        console.log("Getting shit")
        t.get('card', 'shared', 'mb-parent', null).then(async function(parent)
        {
            console.log("Shit got")
            console.log(parent)
            if (parent == null) return;

            console.log("Getting more shit")
            t.cards('id', 'name', 'cover').then(function(cards)
            {
                console.log("More shit got")
                console.log(cards)
                let card = cards.find((c) => c.id == parent)
                console.log(card)
                if (card == null) return;
                
                console.log("Adding shit")
                document.getElementById('parent').innerHTML = "Parent card is <button type='button'>" + card.name + "</button><i class='fa-regular fa-circle-xmark mb-delete' onclick='delete_parent();'></i>"
                console.log("Shit added")
            });
        });
        
        function delete_parent()
        {
            t.set('card', 'shared', 'mb-parent', null);
        }
    </script>
  </body>
</html>
